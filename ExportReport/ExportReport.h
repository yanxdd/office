#ifndef EXPORTREPORT_H
#define EXPORTREPORT_H

#include <QtWidgets/QMainWindow>
#include <QTableWidget>
#include <QLineEdit>
#include <QSqlDatabase>
#include <QSqlQuery>

#include "ui_exportreport.h"
#include "CDataBase.h"
#include "WordEngine.h"

#pragma execution_character_set("utf-8")

class ExportReport : public QMainWindow
{
	Q_OBJECT

public:
	ExportReport(QWidget *parent = 0);
	~ExportReport();

	public slots:

	////////////////////////////////////////////////////////////////////////////////////////////////////
	/// <summary>	Opens the tmpl. </summary>
	/// 解析xml模板配置文件，获取dotx模板路径，列出xml文件中所有标签
	/// <remarks>	user, 2019/3/6. </remarks>
	////////////////////////////////////////////////////////////////////////////////////////////////////
	void OpenTmplSlot();

	////////////////////////////////////////////////////////////////////////////////////////////////////
	/// <summary>	从dotx模板文件新建xml模板配置. </summary>
	///
	/// <remarks>	user, 2019/3/6. </remarks>
	////////////////////////////////////////////////////////////////////////////////////////////////////

	void NewTmplSlot();

	////////////////////////////////////////////////////////////////////////////////////////////////////
	/// <summary>	Saves the tmpl. </summary>
	///
	/// <remarks>	user, 2019/3/6. </remarks>
	////////////////////////////////////////////////////////////////////////////////////////////////////

	void SaveTmplSlot();

	////////////////////////////////////////////////////////////////////////////////////////////////////
	/// <summary>	Exit application. </summary>
	///
	/// <remarks>	user, 2019/3/6. </remarks>
	////////////////////////////////////////////////////////////////////////////////////////////////////

	void ExitAppSlot();

	////////////////////////////////////////////////////////////////////////////////////////////////////
	/// <summary>	显示图表. </summary>
	///
	/// <remarks>	user, 2019/3/9. </remarks>
	////////////////////////////////////////////////////////////////////////////////////////////////////
	void ShowSlot();

	////////////////////////////////////////////////////////////////////////////////////////////////////
	/// <summary>	退出前需提示是否保存. </summary>
	///
	/// <remarks>	user, 2019/3/6. </remarks>
	////////////////////////////////////////////////////////////////////////////////////////////////////

	void ExportWordSlot();

	////////////////////////////////////////////////////////////////////////////////////////////////////
	/// <summary>	双击时弹出设置标签的对话框. </summary>
	///
	/// <remarks>	user, 2019/3/9. </remarks>
	///
	/// <param name="item">	[in,out] If non-null, the item. </param>
	////////////////////////////////////////////////////////////////////////////////////////////////////
	void SetBookMarkSlot(QTableWidgetItem *item);


public:
	////////////////////////////////////////////////////////////////////////////////////////////////////
	/// <summary>	清空界面上所有显示的东西. </summary>
	///
	/// <remarks>	user, 2019/3/9. </remarks>
	////////////////////////////////////////////////////////////////////////////////////////////////////
	void ClearAll();

	CDataBase * Db() const { return _db; }
	void Db(CDataBase * val) { _db = val; }
	
	QWidget * WidgetShow() const { return _widgetShow; }
	void WidgetShow(QWidget * val) { _widgetShow = val; }
	
private:
	/// <summary> 表格 </summary>
	QTableWidget* _tabTmpl;
	/// <summary> WORD模板文件选择框 </summary>
	QLineEdit *_lineTmplPath;

	QDateTimeEdit *_tmStart;
	QDateTimeEdit *_tmEnd;

	CDataBase *_db;

private:
	//Ui::ExportReportClass ui;
	QWidget *_widgetShow;
};

#endif // EXPORTREPORT_H
